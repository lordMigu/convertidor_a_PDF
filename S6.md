# üõ†Ô∏è Prompt 1: Backend (FastAPI + PyMuPDF + FastAPI-Mail)
Copia y pega este prompt para la l√≥gica del servidor:

Contexto: Estoy desarrollando "AntiGravity", un sistema de gesti√≥n documental. Estamos en la Semana 6: Anotaciones y Correos.

Tarea: Implementar dos funcionalidades clave en el backend usando FastAPI:

Endpoint POST /annotate:

Debe recibir un JSON con file_id, y una lista de objetos annotations (x, y, texto, tipo).

Usa PyMuPDF (fitz) para abrir el PDF original, insertar el texto o una marca visual en las coordenadas especificadas.

Debe guardar el resultado como una nueva versi√≥n del archivo o un archivo temporal procesado.

Considera que el origen (0,0) de PyMuPDF es la esquina superior izquierda.

Integraci√≥n de FastAPI-Mail:

Configura un esquema de ConnectionConfig para usar Gmail/Outlook (v√≠a variables de entorno).

Endpoint POST /send-email: Debe permitir enviar un correo con el PDF procesado como adjunto o un enlace de descarga.

Requisitos t√©cnicos:

Manejo de errores si el PDF est√° corrupto o no se encuentra.

Uso de BackgroundTasks para el env√≠o de correos y as√≠ no bloquear la respuesta del API.

Estructura de c√≥digo limpia y tipado con Pydantic.

Genera el c√≥digo necesario para los schemas, los servicios de manipulaci√≥n de PDF y las rutas del router.

# üé® Prompt 2: Frontend (HTML5 + JS Moderno)
Usa este prompt para la interfaz de usuario:

Contexto: Interfaz de usuario para la Semana 6 de AntiGravity. Necesito una forma de interactuar con los PDFs.

Tarea: Crear una interfaz sencilla pero funcional en HTML y JavaScript para:

Visor de Anotaci√≥n:

Un contenedor donde se previsualice el PDF (puedes usar un canvas o un iframe).

Al hacer clic sobre el documento, debe capturar las coordenadas x e y relativas al tama√±o del PDF.

Un peque√±o formulario flotante para escribir el "Texto" de la nota.

L√≥gica de Env√≠o:

Un bot√≥n "Guardar y Enviar" que: a) Env√≠e las coordenadas al endpoint /annotate. b) Tras recibir √©xito, dispare un modal para ingresar un email de destino y llamar a /send-email.

Especificaciones de JS:

Usa fetch() para las llamadas al API.

Implementa una funci√≥n para calcular el escalado: si el PDF se muestra a 500px pero mide 1000px, las coordenadas enviadas al backend deben ser proporcionales.

Estilo minimalista con CSS (puedes usar clases de Tailwind si prefieres).

Entrega el c√≥digo HTML, CSS y el script de JS documentado.

---

# ‚öôÔ∏è Configuraci√≥n de Variables de Entorno


## üìß Paso 1: Configurar Correo Electr√≥nico

### Para Gmail:

1. **Accede a tu cuenta de Gmail**
2. **Activa la verificaci√≥n en 2 pasos**:
   - Ve a [Configuraci√≥n de seguridad de Google](https://myaccount.google.com/security)
   - Activa "Verificaci√≥n en 2 pasos"

3. **Genera una contrase√±a de aplicaci√≥n**:
   - Ve a [Contrase√±as de aplicaci√≥n](https://myaccount.google.com/apppasswords)
   - Selecciona "Correo" y "Otro (nombre personalizado)"
   - Escribe: "FastAPI AntiGravity"
   - Copia la contrase√±a generada (16 caracteres)

4. **Crea o edita el archivo `.env`** en la ra√≠z del proyecto:

```env
# Configuraci√≥n de correo electr√≥nico
MAIL_USERNAME=tu_correo@gmail.com
MAIL_PASSWORD=xxxx xxxx xxxx xxxx  # Contrase√±a de aplicaci√≥n de 16 d√≠gitos
MAIL_FROM=tu_correo@gmail.com
MAIL_PORT=587
MAIL_SERVER=smtp.gmail.com
MAIL_FROM_NAME=Sistema AntiGravity
MAIL_STARTTLS=True
MAIL_SSL_TLS=False
MAIL_USE_CREDENTIALS=True
MAIL_VALIDATE_CERTS=True
```

### Para Outlook/Hotmail:

```env
MAIL_USERNAME=tu_correo@outlook.com
MAIL_PASSWORD=tu_contrase√±a
MAIL_FROM=tu_correo@outlook.com
MAIL_PORT=587
MAIL_SERVER=smtp-mail.outlook.com
MAIL_FROM_NAME=Sistema AntiGravity
MAIL_STARTTLS=True
MAIL_SSL_TLS=False
MAIL_USE_CREDENTIALS=True
MAIL_VALIDATE_CERTS=True
```

## üöÄ Paso 2: Reiniciar el Servidor

Despu√©s de configurar las variables:

```bash
uvicorn app.main:app --reload
```

## ‚úÖ Paso 3: Verificar que Funciona

Prueba los endpoints en **Swagger UI**:
- Navega a: `http://localhost:8000/docs`
- Busca la secci√≥n **"annotations"**
- Prueba:
  - `POST /api/v1/annotations/annotate` - Para agregar anotaciones
  - `POST /api/v1/annotations/send-email` - Para enviar correos

## üîê Notas de Seguridad

‚ö†Ô∏è **IMPORTANTE**: 
- **Nunca** subas el archivo `.env` a repositorios p√∫blicos
- Agrega `.env` a tu `.gitignore`
- Usa `.env.example` como plantilla sin datos sensibles
- En producci√≥n, usa variables de entorno del servidor (no archivos .env)

## üìù Ejemplo de .gitignore

```gitignore
# Variables de entorno
.env
.env.local

# Base de datos
*.db
*.sqlite

# Archivos temporales
uploads/
temp_files/
```