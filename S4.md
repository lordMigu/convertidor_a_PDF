# Semana 4: Sistema de Permisos y Colaboraci√≥n

En esta fase hemos transformado la aplicaci√≥n de una herramienta personal a una plataforma colaborativa multiusuario.

## üõ†Ô∏è Implementaciones Realizadas (Backend)

1.  **Modelo de Datos Robusto**:
    *   Creaci√≥n de la tabla `Permission` para gestionar accesos granulares.
    *   Soporte para 3 niveles de acceso:
        *   `owner`: Control total, gesti√≥n de permisos y eliminaci√≥n.
        *   `editor`: Capacidad de subir nuevas versiones del documento.
        *   `viewer`: Acceso de solo lectura y descarga.

2.  **Seguridad Avanzada**:
    *   **Middleware `verify_document_access`**: Una nueva capa de seguridad que protege cada acci√≥n. Si un usuario intenta editar o descargar un archivo sin permiso, el sistema lo bloquea con un error `403 Forbidden`.
    *   **Propiedad Autom√°tica**: Cada vez que subes un archivo, el sistema te registra autom√°ticamente como el `owner`.

3.  **Nuevas Funcionalidades**:
    *   **Endpoint de Compartici√≥n**: `POST /api/v1/files/{id}/share` permite invitar a otros usuarios usando su correo electr√≥nico.
    *   **Dashboard Unificado**: El historial de "Mis Documentos" ahora muestra tanto tus archivos propios como los que otros usuarios han compartido contigo.

4.  **Mantenimiento**:
    *   Migraci√≥n a `argon2` para una autenticaci√≥n m√°s segura y compatible con Python 3.13.

---

## üöÄ Prompt Ideal para la Integraci√≥n del Frontend

Si deseas que una IA implemente la interfaz de usuario para estas funciones, este es el prompt recomendado:

> "Act√∫a como experto en Frontend (JS/CSS). Necesito integrar el nuevo Sistema de Permisos en mi Dashboard. 
> 
> **Tareas Visuales:**
> 1. **Bot√≥n de Compartir**: A√±ade un icono de 'usuario+' en cada fila del historial. Al abrirlo, debe mostrar un modal para ingresar un email y elegir el nivel (Lector o Editor).
> 2. **Indicadores de Acceso**: Si un documento es compartido conmigo, a√±ade una peque√±a etiqueta (badge) que diga 'Compartido'.
> 3. **Control de Interfaz**: 
>    - Deshabilita el bot√≥n de 'Eliminar' si mi nivel de permiso no es 'owner'.
>    - Oculta el bot√≥n de 'Nueva Versi√≥n' si mi nivel es 'viewer'.
> 
> **L√≥gica de API:**
> - Implementa la funci√≥n `shareDocument(docId, email, level)` que conecte con el endpoint `POST /api/v1/files/{id}/share`.
> - Maneja los errores: si el email no existe, muestra un mensaje de alerta 'Usuario no encontrado'.
> 
> **Estilo**: Sigue la est√©tica actual de la aplicaci√≥n (colores ITB, sombras suaves y transiciones r√°pidas)."
